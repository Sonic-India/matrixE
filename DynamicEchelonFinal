#include <stdio.h>
#include<stdlib.h>
float **CreateMatrix(int rows, int cols)
 {
  float **matrix = malloc(sizeof(float*) * rows);
  int i;
  for (i = 0; i < rows; i++)
    {
    matrix[i] = malloc(sizeof(float) * cols);
    }
  return matrix;
}
void MatrixInput(int **matrix, int rows, int cols)
{
  int i, j;
  for (i = 0; i < rows; i++)
  {
    for (j = 0; j < cols; j++)
    {
      printf("\n Enter element[%d][%d] :",i,j);
      scanf("%d", &matrix[i][j]);
    }
  }
}
int main()
 {
  float **a;float **b;
  int m,n,i,j,r,k,c,d; float y,z;int x;float temp;
  printf("\n Enter number of Rows : ");
  scanf("%d", &m);
  printf("\n Enter number of Columns : ");
  scanf("%d", &n);
  a= CreateMatrix(m, n);
  MatrixInput(a, m, n);

    for(i=0;i<m;i++)
    {
        for(j=0;j<n;j++)
        {
            printf("\n Enter matrix element [%d][%d]  :",i,j);
            scanf("%f",&a[i][j]);
            b[i][j]=a[i][j];
        }
    }
    printf("\n******Input Matrix******\n\n");
    for(i=0;i<m;i++)
    {
        for(j=0;j<n;j++)
        {
         x=(int)b[i][j];
         y=b[i][j];z=b[i][j];y=y-x;
         if(y==0)
            printf("       %d",x);
         else
            printf("       %f",z);
        }
        printf("\n");
    }
    printf("\n\n");
    for(c=0;c<(m-1);c++)
   {
      if(b[c][c]==0)
      {
          for(d=0;d<(m-c-1);d++)
          {
              if(b[c+d+1][c]!=0)
              {
                  for(j=0;j<n;j++)
                  {
                      temp=b[c+d+1][j];b[c+d+1][j]=b[c][j];b[c][j]=temp;
                  }
              }
              else
                 continue;
            break;
          }
      }
                  for(r=0;r<m;r++)
            {
              for(k=0;k<n;k++)
              {
                 a[r][k]=b[r][k];
              }
            }
       for(d=0;d<(m-c-1);d++)
       {
               if(a[c+d+1][c]!=0)
               {
                  for(j=0;j<n;j++)
                 {
                   a[c+d+1][j]=(b[c+d+1][j])    -    ((b[c+d+1][c]/b[c][c])*b[c][j]);
                 }
               }
            for(r=0;r<m;r++)
            {
              for(k=0;k<n;k++)
              {
                 b[r][k]=a[r][k];
              }
            }
            for(i=0;i<m;i++)
            {
                for(j=0;j<n;j++)
                {
         x=(int)b[i][j];
         y=b[i][j];z=b[i][j];y=y-x;
         if(y==0)
            printf("       %d",x);
         else
            printf("       %f",z);
                }
                  printf("\n");
            }
             printf("\n\n");
       }

   }
   printf("*****Echelon Form*****\n");
   for(i=0;i<m;i++)
    {
        for(j=0;j<n;j++)
        {
            x=(int)b[i][j];
            y=b[i][j];z=b[i][j];y=y-x;
            if(y==0)
               printf("       %d",x);
            else
               printf("       %d",z);
        }
        printf("\n");
     }
}

